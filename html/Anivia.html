<!DOCTYPE html>
<html>
<head>
<style>

img{
	opacity: 1.0;
}
body{
	background-color: #000000;
	margin: 0;
	padding: 0;
	scrollbar-base-color: #333333;
	scrollbar-track-color: #111111;
	scrollbar-arrow-color: #000000;
	scrollbar-3dlight-color: #000000;
}
h1{
	text-indent: 20px
}
#header{
	text-align:center;
	padding:5px;
	font-family: "PT Sans Narrow", serif;
}
#loadingPic{
	float: left;
	width: 300px;
	text-align: center;
}
#stats{
	float: left;
	padding: 45px;
	text-align: center;
}
#stats2{
	float: left;
	padding: 45px;
	text-align: center;
}
#footer{
	clear: both;
}

div.background{
	background-image: url(http://ddragon.leagueoflegends.com/cdn/img/champion/splash/Anivia_1.jpg) ;
	background-repeat: no-repeat;
	background-size: cover;
	box-shadow: inset 0px 0px 15px 15px rgba(0,0,0,1);
	margin-top: 0px;
	background-attachment: fixed;
}
div.transbox{
	background-color: rgba(255,255,255,0.8);
	margin-left: 97px;
	width: 1020px;
	height: 80%;
	box-shadow: 0px 0px 15px 15px rgba(0,0,0,1);
}
div.pseudobox{
	margin-left: 97px;
	background-color: rgba(255,255,255,0);
}
div.pseudobox2{
	margin-left: 325px;
	text-align: center;
	background-color: rgba(255,255,255,0);
	<!--background-color: #000000;-->
}
div.itemUsers{
	text-align: left;
}
div.itemUserNames{
	width:400px;
}
span.itemUsage{
	margin-left: 100px;
	background-color: rgba(255,255,255,1);
	text-align: left;
}
</style>

<!--div.textwrap{
	background-color: #ffffff;
	opacity: 0.5;
}
</style>-->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<script>
$(document).ready(function(){

    $("#hs_gamesPlayed").click(function(){
        $("#gamesPlayed_chart").toggle('show');
    });

    $("#hs_dps").click(function(){
        $("#dps_chart").toggle('show');
    });

    $("#hs_dpschamp").click(function(){
        $("#dpschamp_chart").toggle('show');
    });

    $("#hs_ccps").click(function(){
        $("#ccps_chart").toggle('show');
    });

    $("#hs_kda").click(function(){
        $("#kda_chart").toggle('show');
    });
	
    $("#hs_items").click(function(){
        $("#itemTable").toggle('show');
    });
	
	$("#hs_showall").click(function(){
		$("#gamesPlayed_chart").show('show');
		$("#dps_chart").show('show');
		$("#dpschamp_chart").show('show');
		$("#ccps_chart").show('show');
		$("#kda_chart").show('show');
		$("#itemTable").show('show');
    });
	
	$("#hs_hideall").click(function(){
		$("#gamesPlayed_chart").hide('show');
		$("#dps_chart").hide('show');
		$("#dpschamp_chart").hide('show');
		$("#ccps_chart").hide('show');
		$("#kda_chart").hide('show');
		$("#itemTable").hide('show');
    });
});
</script>

</head>

<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<div class='background'>
<div class='transbox'>
<div class='pseudobox'>
<div id='header'>
<p id='tth'></p>
</div>
<div id='loadingPic'>
<h1>Anivia</h1>
<img src='http://ddragon.leagueoflegends.com/cdn/img/champion/loading/Anivia_0.jpg' style='border:none' opacity='1.0'></img>
<p id='midFrame'> </p>

<!--<script type='text/javascript'>
var itemUrl = "https://raw.githubusercontent.com/riderShigh/API2/master/bigItemNameIds.json";
var xmlhttpI = new XMLHttpRequest();

xmlhttpI.onreadystatechange=function() {
	if (xmlhttpI.readyState == 4 && xmlhttpI.status == 200) {
		loadItems(xmlhttpI.responseText);
	}
}
xmlhttpI.open("GET", itemUrl, true);
xmlhttpI.send();

function loadItems(response){
	var arrItems = JSON.parse(response);
	document.getElementById('tth').innerHTML = arrItems['eune'][];
}

</script>-->

</div>

<div class='pseudobox2'>

<div> 
    <p>Click on a button to show/hide a chart. Hover on bars to see exact numbers.</p>
<br>
</div>

<button id="hs_gamesPlayed">Win Rate</button>
<button id="hs_kda">KDA</button>
<button id="hs_dps">DPS</button>
<button id="hs_dpschamp">DPS to Champions</button>
<button id="hs_ccps">Crowd Control Duration</button>
<div>
<button id="hs_items">Item Popularity</button>
<button id="hs_showall">Show All</button>
<button id="hs_hideall">Hide All</button>
</div>

<div id="gamesPlayed_chart" style="display:block"></div>
<div id="kda_chart" style="display:block"></div>
<div id="dps_chart" style="display:none"></div>
<div id="dpschamp_chart" style="display:none"></div>
<div id="ccps_chart" style="display:none"></div>
<p> </p>

<div class='itemTable' id='itemTable' style='display:none'>
<table>
<col width=170>
<th colspan='2'>Item Purchase Popularity</th>
<tr><td> </td><td> </td></tr>
<tr><td>Patch 5.11 Mains</td><td><div id="itemUsage_Mains511"></div></td></tr>
<tr><td>Patch 5.11 Avg</td><td><div id="itemUsage_Avg511"></div></td></tr>
<tr><td>Patch 5.14 Mains</td><td><div id="itemUsage_Mains514"></div></td></tr>
<tr><td>Patch 5.14 Avg</td><td><div id="itemUsage_Avg514"></div></td></tr>
</table>
</div>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type='text/javascript'>
google.load('visualization', '1', {packages: ['corechart', 'bar']});
var xmlhttp = new XMLHttpRequest();
var xmlhttp2 = new XMLHttpRequest(); 
var xmlhttp3 = new XMLHttpRequest();
var url = "https://raw.githubusercontent.com/riderShigh/API2/master/statsCompare/5.11/34/champStats.json";
var url2 = "https://raw.githubusercontent.com/riderShigh/API2/master/statsCompare/5.14/34/champStats.json";
var url3 = "https://raw.githubusercontent.com/riderShigh/API2/master/bigItemNameIds.json";

xmlhttp.onreadystatechange=function() {
	if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
	
		xmlhttp2.onreadystatechange=function() {
			if (xmlhttp2.readyState == 4 && xmlhttp2.status == 200) {
				//myFunction(xmlhttp2.responseText,"stats2");
				//myFunction(xmlhttp.responseText,"stats");
				plot(xmlhttp.responseText,xmlhttp2.responseText);

				xmlhttp3.onreadystatechange=function() {
					if (xmlhttp3.readyState == 4 && xmlhttp3.status == 200) {
					
						showItems(xmlhttp.responseText,xmlhttp2.responseText,xmlhttp3.responseText);
					}
				}

				xmlhttp3.open("GET", url3, false);
				xmlhttp3.send();
				
			}
		}
		xmlhttp2.open("GET", url2, false);
		xmlhttp2.send();
		//myFunction(xmlhttp.responseText);
	}
}
xmlhttp.open("GET", url, false);
xmlhttp.send();

function plot(response1,response2){

	var arr = JSON.parse(response1);
	var arr2 = JSON.parse(response2);
	var oldavg = arr.gamesWon.avg/arr.gamesRecorded.avg*100;
	var oldmains = arr.gamesWon.mains/arr.gamesRecorded.mains*100;
	var newavg = arr2.gamesWon.avg/arr2.gamesRecorded.avg*100;
	var newmains = arr2.gamesWon.mains/arr2.gamesRecorded.mains*100;
	
	google.setOnLoadCallback(drawStacked);
	
	function drawStacked() {
      
	  /*var data = google.visualization.arrayToDataTable([
        ['Games Played', 'Wins', 'Loses',{role:'annotation'}],
        ['5.11 Avg', arr.gamesWon.avg, arr.gamesRecorded.avg-arr.gamesWon.avg, oldavg.toString()],
		['5.11 Mains', arr.gamesWon.mains, arr.gamesRecorded.mains-arr.gamesWon.mains, oldmains.toString()],
		['5.14 Avg', arr2.gamesWon.avg, arr2.gamesRecorded.avg-arr2.gamesWon.avg, newavg.toString()],
		['5.14 Mains', arr2.gamesWon.mains, arr2.gamesRecorded.mains-arr2.gamesWon.mains, newmains.toString()],
		
      ]);*/
	  
	  var data = google.visualization.arrayToDataTable([
        ['Win Rate', '5.11','5.14'],
        ['Avg', oldavg, newavg],
		['Mains', oldmains, newmains],
	
      ]);
	  
	  var view = new google.visualization.DataView(data);
  

      var options = {
        title: 'Win Rate',
        chartArea: {width: '62%'},
        isStacked: false,
		backgroundColor: { fill:'transparent' },
		colors: ['#d95f02','#3b8686'],
        hAxis: {
          title: 'Win Rate (%)',
          minValue: 0,
        },
        //vAxis: {
        //  title: ''
        //},
		bar: { groupWidth: "20"},
		width: 530,
		height: 150
      };
      var chart = new google.visualization.BarChart(document.getElementById('gamesPlayed_chart'));
      chart.draw(data, options);
    }
	
	google.setOnLoadCallback(drawDPS);
	
	function drawDPS() {
      var data = google.visualization.arrayToDataTable([
        ['DPS', 'winning', 'losing'],
        ['5.11 Avg', arr.totalDamageDealt.win.avg, arr.totalDamageDealt.lose.avg],
		['5.11 Mains', arr.totalDamageDealt.win.mains, arr.totalDamageDealt.lose.mains],
		['5.14 Avg', arr2.totalDamageDealt.win.avg, arr2.totalDamageDealt.lose.avg],
		['5.14 Mains', arr2.totalDamageDealt.win.mains, arr2.totalDamageDealt.lose.mains],
		
      ]);

      var options = {
        title: 'Damage per Second (DPS)',
        chartArea: {width: '62%'},
        isStacked: false,
		backgroundColor: { fill:'transparent' },
        hAxis: {
          title: 'DPS',
          minValue: 0,
        },
        //vAxis: {
        //  title: ''
        //},
		bar: { groupWidth: "20"},
		width: 530,
		height: 250
      };
      var chart = new google.visualization.BarChart(document.getElementById('dps_chart'));
      chart.draw(data, options);
    }	

	
	google.setOnLoadCallback(drawDPSChamps);
	
	function drawDPSChamps() {
      var data = google.visualization.arrayToDataTable([
        ['DPS', 'winning', 'losing'],
        ['5.11 Avg', arr.totalDamageToChampions.win.avg, arr.totalDamageToChampions.lose.avg],
		['5.11 Mains', arr.totalDamageToChampions.win.mains, arr.totalDamageToChampions.lose.mains],
		['5.14 Avg', arr2.totalDamageToChampions.win.avg, arr2.totalDamageToChampions.lose.avg],
		['5.14 Mains', arr2.totalDamageToChampions.win.mains, arr2.totalDamageToChampions.lose.mains],
		
      ]);

      var options = {
        title: 'Damage per Second to Champions',
        chartArea: {width: '62%'},
        isStacked: false,
		backgroundColor: { fill:'transparent' },
        hAxis: {
          title: 'DPS to Champions',
          minValue: 0,
        },
        //vAxis: {
        //  title: ''
        //},
		bar: { groupWidth: "20"},
		width: 530,
		height: 250
      };
      var chart = new google.visualization.BarChart(document.getElementById('dpschamp_chart'));
      chart.draw(data, options);
    }		

	google.setOnLoadCallback(drawCCPS);
	
	function drawCCPS() {
      var data = google.visualization.arrayToDataTable([
        ['CCPS', 'winning', 'losing'],
        ['5.11 Avg', arr.totalTimeCrowdControlDealt.win.avg*100, arr.totalTimeCrowdControlDealt.lose.avg*100],
		['5.11 Mains', arr.totalTimeCrowdControlDealt.win.mains*100, arr.totalTimeCrowdControlDealt.lose.mains*100],
		['5.14 Avg', arr2.totalTimeCrowdControlDealt.win.avg*100, arr2.totalTimeCrowdControlDealt.lose.avg*100],
		['5.14 Mains', arr2.totalTimeCrowdControlDealt.win.mains*100, arr2.totalTimeCrowdControlDealt.lose.mains*100],
		
      ]);

      var options = {
        title: 'Percentage Game Time Dealing Crowd Control (CCPS)',
        chartArea: {width: '62%'},
        isStacked: false,
		backgroundColor: { fill:'transparent' },
        hAxis: {
          title: 'CCPS (%)',
          minValue: 0,
        },
        //vAxis: {
        //  title: ''
        //},
		bar: { groupWidth: "20"},
		width: 530,
		height: 250
      };
      var chart = new google.visualization.BarChart(document.getElementById('ccps_chart'));
      chart.draw(data, options);
    }	
	
	google.setOnLoadCallback(drawKDA);
	
	function drawKDA() {
      var data = google.visualization.arrayToDataTable([
        ['CCPS', 'winning', 'losing'],
        ['5.11 Avg', arr.KDA.win.avg*100, arr.KDA.lose.avg*100],
		['5.11 Mains', arr.KDA.win.mains*100, arr.KDA.lose.mains*100],
		['5.14 Avg', arr2.KDA.win.avg*100, arr2.KDA.lose.avg*100],
		['5.14 Mains', arr2.KDA.win.mains*100, arr2.KDA.lose.mains*100],
		
      ]);

      var options = {
        title: 'KDA',
        chartArea: {width: '62%'},
        isStacked: false,
		backgroundColor: { fill:'transparent' },
        hAxis: {
          title: 'KDA',
          minValue: 0,
        },
        //vAxis: {
        //  title: ''
        //},
		bar: { groupWidth: "20"},
		width: 530,
		height: 250
      };
      var chart = new google.visualization.BarChart(document.getElementById('kda_chart'));
      chart.draw(data, options);
    }
}

function showItems(response1,response2,response3){
	
	var arr = [];
	arr.push(JSON.parse(response1));
	arr.push(JSON.parse(response2));
	var itemList = JSON.parse(response3);
	
	/*var items511mains = arr['itemUsage']['mains'];
	var items511avg = arr['itemUsage']['avg'];
	var items514mains = arr2['itemUsage']['mains'];
	var items514avg = arr2['itemUsage']['avg'];*/
	
	var patch = ['5.14','5.14'];
	var patch1 = ['511','514'];
	var type = ['mains','avg'];
	var type1 = ['Mains','Avg'];
	//var stringThis = 'itemUsage_'+ type1[0] + patch1[0].toString();
	//document.getElementById('itemUsage_'+ type1[0] + patch1[0].toString()).innerHTML = stringThis;
	
	for(var a1=0; a1<2; a1++){
		for(var a2=0; a2<2; a2++){
			var newList = {};
			for(var keyA in arr[a2]['itemUsage'][type[a1]]){
				if(arr[a2]['itemUsage'][type[a1]].hasOwnProperty(keyA)){
					for(var keyB in itemList['na'][patch[a2]]){
						if(itemList['na'][patch[a2]].hasOwnProperty(keyB.toString())){
							//document.getElementById('tth').innerHTML = key;
							if(keyA==itemList['na'][patch[a2]][keyB]){
								newList[keyB.toString()] = arr[a2]['itemUsage'][type[a1]][keyA];
							}
						}
					}
				}
			}
			
			var sortable = [];
			for(var keyC in newList){sortable.push([keyC, newList[keyC]]);}
			sortable.sort(function(a, b) {return b[1] - a[1]});
			
			var outA = '<table><tr>';
			for(var k=0; k<6; k++){
				var itemUrl = 'http://ddragon.leagueoflegends.com/cdn/' + patch[a2].toString() + '.1/img/item/' + sortable[k][0].toString() + '.png';
				outA += "<td><img src=" + itemUrl + " width='50px'></img></td>";

			}
			outA += '</tr><tr>';
			for(var k=0; k<6; k++){
				var itemUrl = 'http://ddragon.leagueoflegends.com/cdn/' + patch[a2].toString() + '.1/img/item/' + sortable[k][0].toString() + '.png';
				var thisUsage = sortable[k][1]*100;
				thisUsage = thisUsage.toFixed(2);
				outA += '<td>' + thisUsage.toString() + "% </td>";
			}			
			outA += '</table>';
			
			document.getElementById('itemUsage_'+ type1[a1] + patch1[a2].toString()).innerHTML = outA;
		}
	}
	
}


</script>


<footer>
<div id='footer'></div>
</footer>
</div>
</div>
</div>

<script>
$(function(){
$(#hs_all).trigger('click');
});
</script>

</body>

</html>